<!DOCTYPE html>

<html lang="es">
<head>
    <!--IDIOMA DE LOS CARACTERES-->
    <meta charset="utf-8" />
    <!--TÍTULO-->
    <title>PAX | DIGITAL MINDS</title>
    <!--ICONO-->
    <link rel="icon" type="favicon/x-icon" href="../../images/icon.png" />
    <!--LLAMADA A LAS HOJAS DE ESTILO-->
    <link rel="stylesheet" type="text/css" href="../../stylesheets/General.css" />
    <link rel="stylesheet" type="text/css" href="../../stylesheets/areausuarios.css" />

    <!--LLAMADA A LOS SCRIPTS-->
    <script src="../../scripts/RRSS.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>


    <!--METADATOS-->
    <meta name="author" content="Maximiliano Serratosa" />
    <meta name="robots" content="follow" />
    <meta name="description" content="PAX | DIGITAL MINDS es tu solucion para tu aplicacion web" />
    <meta name="keywords" content="html, css, javascript, php, diseño web, ajax, mysql" />
    <meta name="revisit-after" content="7 days" />
    <meta name="category" content="Web app" />
</head>
<body>

    <!--INICIO DE LA CABECERA-->
    <header id="header">
        <div class="wrap">
            <div id="logo">
                <span class="displ"><img src="../../images/icon.png" alt="logo" /></span>
                <h1>PAX | DIGITAL MINDS</h1>
            </div>

            <!--MENÚ DE NAVEGACIÓN-->
            <nav id="menu">
                <ul>
                    <li><a href="../../index.html" class="btn">INICIO</a></li>
                    <li><a href="../../views/galeria.html" class="btn">GALER&Iacute;A</a></li>
                    <li><a href="../../views/presupuesto.html" class="btn">PRESUPUESTO</a></li>
                    <li><a href="../../views/contacto.html" class="btn">CONTACTO</a></li>
                    <li><a href="#" class="btn_in">AREA USUARIOS</a></li>
                </ul>
            </nav>
        </div>
     </header>


<section class="wrap wrap-content"><h2>Nuevo usuario</h2>
        <section class="info">
            <!--INICIO DEL BANNER-->
            <div id="banner"><h2>Nuevo usuario</h2></div>
        </section>

        <!--INICIO DEL FORMULARIO-->
        <div id="formulario">
            <!--DATOS PERSONALES-->
            <section>
                <div class="title">
                    <h2>Datos del nuevo usuario</h2>
                </div>
                <div id="signup">
                
                   <form action="../controllers/nuevo-usuario.php" method="post">
                    <!--USUARIO-->
                        
                        <label id="user-icon" class="icon">U</label>
                        <input type="text" name="user" id="user" placeholder="Inserte su nombre de usuario"><br/>
                    <!--NOMBRE-->
                        <label id="user-icon" class="icon">U</label>
                        <input type="text" name="name" id="name" placeholder="Inserte su nombre "><br/>
                    <!--APELLIDO-->
                        <label id="user-icon" class="icon">U</label>
                        <input type="text" name="surname" id="surname" placeholder="Inserte su apellido"><br/>
                    <!--CONTRASEÑA-->
                        <label id="password-icon" class="icon">w</label>
                        <input type="text" name="password" id="password" placeholder="Inserte su contraseña"><br/>

                    <!--EMAIL-->   
                        <label id="email-icon" class="icon">@</label>
                        <input type="email" name="email" id="email" placeholder="Inserte su E-mail"><br/>

                    <!--TELEFONO-->
                        <label id="telf-icon" class="icon">¹</label>
                        <input type="tel" name="telf" id="telf" placeholder="Inserte su tel&eacute;fono"><br/>
                    
                    <div class="last">
                        
                        <input type="reset" name="VaciarFormulario" id="reset" class="boton_secundario" onclick="resetear()" />
                        <input type="submit" name="Acceder" value="Enviar" class="boton_primario" id="enviar">
                        <br/><br/><a href='../areausuarios.php' class="boton_secundario" id="back_button">VOLVER ATRÁS</a>
                        <br/><br/><span id="error" class="nvaliduser"></span>
                    </div>
                </div>
                                                
                </form>
                
                </div>

            </section>
    </section>

    <!--COMPROBACIONES-->
<script>

let $usuario = $('#user');
let $nombre = $('#name');
let $apellido = $('#surname');
let $contraseña = $('#password');
let $email = $('#email');
let $telefono = $('#telf');
let $usuarioRegistrado;
let $emailRegistrado;
let $telefonoRegistrado;

$('#enviar').mouseenter(function(){
    let dataType="html";

    //COMPROBAMOS QUE EL USUARIO NO ESTÉ REGISTRADO
    $.ajax({
        type: "POST",
        url: "../helpers/validators/validateuser.php",
        data: 'user='+$("#user").val(),
        success: function(userData){if(userData === "true"){$usuarioRegistrado = true}
        else if(userData === "false"){$usuarioRegistrado = false}},
    });
    console.log('Usuario:' + $usuarioRegistrado);

    // COMPROBAMOS QUE EL EMAIL NO ESTÉ REGISTRADO
    $.ajax({
        type: "POST",
        url: "../helpers/validators/validateemail.php",
        data: 'email='+$("#email").val(),
        success: function(emailData){if(emailData === "true"){$emailRegistrado = 'true'}
        else if(emailData === "false"){$emailRegistrado = 'false'}},
        
    });   
    console.log('Email:' + $emailRegistrado);
    
    // COMPROBAMOS QUE EL TELEFONO NO ESTÉ REGISTRADO
    $.ajax({
        type: "POST",
        url: "../helpers/validators/validatetelf.php",
        data: 'telf='+$("#telf").val(),
        success: function(telfData){if(telfData === "true"){$telefonoRegistrado = true}
        else{$telefonoRegistrado = false}},
    });
    console.log('Telefono:' + $telefonoRegistrado);
    console.log('=================================');
})

$('#enviar').focusin(function(){
    let dataType="html";

    //COMPROBAMOS QUE EL USUARIO NO ESTÉ REGISTRADO
    $.ajax({
        type: "POST",
        url: "../helpers/validators/validateuser.php",
        data: 'user='+$("#user").val(),
        success: function(userData){if(userData === "true"){$usuarioRegistrado = 'true'}
        else if(userData === "false"){$usuarioRegistrado = 'false'}},
    });
    console.log('Usuario:' + $usuarioRegistrado);

    // COMPROBAMOS QUE EL EMAIL NO ESTÉ REGISTRADO
    $.ajax({
        type: "POST",
        url: "../helpers/validators/validateemail.php",
        data: 'email='+$("#email").val(),
        success: function(emailData){if(emailData === "true"){$emailRegistrado = 'true'}
        else if(emailData === "false"){$emailRegistrado = 'false'}},
        
    });   
    console.log('Email:' + $emailRegistrado);
    
    // COMPROBAMOS QUE EL TELEFONO NO ESTÉ REGISTRADO
    $.ajax({
        type: "POST",
        url: "../helpers/validators/validatetelf.php",
        data: 'telf='+$("#telf").val(),
        success: function(telfData){if(telfData === "true"){$telefonoRegistrado = 'true'}
        else{$telefonoRegistrado = 'false'}},
    });
    console.log('Telefono:' + $telefonoRegistrado);
    console.log('=================================');
})

$("form").submit(function(event) {
    
    console.log('Usuario:' + $usuarioRegistrado);
    console.log('Email:' + $emailRegistrado);
    console.log('Telefono:' + $telefonoRegistrado);
    console.log('=================================');
    
if($usuarioRegistrado == 'true'){ //COMPROBAMOS QUE EL USUARIO NO ESTÉ REGISTRADO
    $('#error').html('Ya existe una cuenta con ese nombre de usuario');
    event.preventDefault();
}else if($emailRegistrado == 'true'){ //COMPROBAMOS QUE EL EMAIL NO ESTÉ REGISTRADO
    $('#error').html('Ya existe una cuenta con ese correo electrónico');
    event.preventDefault();
}else if($telefonoRegistrado == 'true'){ //COMPROBAMOS QUE EL TELÉFONO NO ESTÉ REGISTRADO
    $('#error').html('Ya existe una cuenta con ese teléfono');
    event.preventDefault();
}else if($usuario.val().length <=0){ //COMPROBAMOS QUE USUARIO NO ESTÉ VACÍO
    $('#error').html('Debe rellenar el campo <b>USUARIO</b>');
    event.preventDefault();
}else if($nombre.val().length <=0){ //COMPROBAMOS QUE EL NOMBRE NO ESTÉ VACÍO
    $('#error').html('Debe rellenar el campo <b>NOMBRE</b>');
    event.preventDefault();
}else if($apellido.val().length <=0){ //COMPROBAMOS QUE EL APELLIDO NO ESTÉ VACÍO
    $('#error').html('Debe rellenar el campo <b>APELLIDO</b>');
    event.preventDefault();
}else if($contraseña.val().length <=0){ //COMPROBAMOS QUE LA CONTRASEÑA NO ESTÉ VACÍA
    $('#error').html('Debe rellenar el campo <b>CONTRASEÑA</b>');
    event.preventDefault();
}else if($email.val().length <=0){ //COMPROBAMOS QUE EL EMAIL NO ESTÉ VACÍO
    $('#error').html('Debe rellenar el campo <b>EMAIL</b>');
    event.preventDefault();
}else if($telefono.val().length <=0){ //COMPROBAMOS QUE EL TELÉFONO NO ESTÉ VACIO
    $('#error').html('Debe rellenar el campo <b>TELEFONO</b>');
    event.preventDefault();}
    else{$('#error').html('')}
});

</script>

<!--PIE DE PÁGINA-->
    <div class="clearfix"></div>
    <footer id="footer">

        <div class="wrap">


            <div>
                <h5>PAX | DIGITAL MINDS</h5>
                <!--DIRECCION-->
                Avenida de Palmela 19 - 03730 J&aacute;vea (Alicante)<br />
                <!--AVISO LEGAL-->
                <p>
                    <a href="#" class="advice">Política de cookies</a>&nbsp; | &nbsp;
                    <a href="#" class="advice">Política de privacidad</a>&nbsp; | &nbsp;
                    <a href="views/avisolegal.html" class="advice">Aviso Legal</a>
                </p>
                <!--RRSS-->
                <p>
                    <a href="#" class="rrss" onmouseover="fbhover()" onmouseout="fbblack()"><img id="fb" alt="Facebook" src="../../images/rrss/facebook.png" /></a> &nbsp;
                    <a href="#" class="rrss" onmouseover="ighover()" onmouseout="igblack()"><img id="ig" alt="Instagram" src="../../images/rrss/instagram.png" /></a> &nbsp;
                    <a href="#" class="rrss" onmouseover="twhover()" onmouseout="twblack()"><img id="tw" alt="twitter" src="../../images/rrss/twitter.png" /></a>
                </p>&copy; PAX | DIGITAL MINDS 2022
            </div>

        </div>
    </footer>

</body>
</html>